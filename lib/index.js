!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.puppeteer=t():e.puppeteer=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),c=function(e){var t=window,n={},c=e.loader||u.default,i={},a=null,s=!1,p=!1,f=function(){var t;e.dev&&(t=console).log.apply(t,arguments)},l=function(){var e;(e=console).warn.apply(e,arguments)},d=function(){var e;(e=console).error.apply(e,arguments)};return t.puppeteerActive=!0,"function"!=typeof c&&d("Provider app loader is not a function"),e.apps&&"object"===o(e.apps)||d('Missing "apps" object definition'),Object.keys(e.apps).forEach(function(t){var n=e.apps[t];n.bundleLocation||d('Missing "bundleLocation" for app',t),n.domHook||d('Missing "domHook" (element id) for app',t),n.mountFuncName||d('Missing "mountFuncName" (global mount function) for app',t)}),{subscribe:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};p&&["STORE:GET","STORE:SET","STORE:CHANGE"].includes(e)&&l("Piggybacking on STORE.GET/SET/CHANGE prohibited"),n.hasOwnProperty(e)||(n[e]=[]);var r=n[e].push(t)-1;return function(){return delete n[e][r]}},publish:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f("--- TOPIC LAUNCHED ---",e,t);var r=n[e]&&n[e].length?n[e].map(function(e){return e(t)}):[];return Promise.all(r)},store:function(e,t){if(!p)return l("Store is not attached",e,t),!1;var n=this;switch(e){case"GET":return n.publish("STORE:GET",t).then(function(e){return e[0]});case"SET":return n.publish("STORE:SET",t);case"CHANGE":return n.subscribe("STORE:CHANGE",t);default:l("Unrecognised Store action",e,t)}},generateAppEvents:function(){var n=this,r=e.apps;return Object.keys(r).forEach(function(e){n.subscribe("".concat(e.toUpperCase(),":MOUNT"),function(){return!!r[e].mounted||c(r[e].bundleLocation).then(function(){r[e].mounted=!0;var o=t[r[e].mountFuncName];if(!o)return l("Couldn't find mount function window."+r[e].mountFuncName),!1;r[e].unmount=o(n,r[e].domHook),n.publish("".concat(e.toUpperCase(),":MOUNT_SUCCESS"))})}),n.subscribe("".concat(e.toUpperCase(),":ACTION"),function(o){return r[e].mounted?a!==e&&(a&&r[a].unmount&&(n.publish("".concat(a.toUpperCase(),":UNMOUNT")),r[a].unmount||l(r[a].mountFuncName+"did not return unmount function"),r[a].unmount(),r[a].mounted=!1),a=e,void(!o.skipHashUpdate&&s&&(t.location.hash="#/".concat(e.toLowerCase())))):n.publish("".concat(e.toUpperCase(),":MOUNT")).then(function(){n.publish("".concat(e.toUpperCase(),":ACTION"),o)})})}),n},initiateAppRouter:function(){var n=this,r=e.apps;return n.subscribe("ROUTER:CUSTOM_HASH_CHANGE",function(){var e=t.location.hash,o=!1;if(Object.keys(r).forEach(function(t){var r=new RegExp("^#/"+t.toLowerCase()+"($|/)","g");e.match(r)&&(o=!0),e.match(r)&&a!==t&&n.publish("".concat(t.toUpperCase(),":ACTION"),{type:"openApp",skipHashUpdate:!0})}),o)return!0;n.publish("ROUTER:NONE_EXISTING_ROUTE"),a&&r[a].unmount&&(r[a].unmount(),r[a].mounted=!1,a=null)}),t.addEventListener("hashchange",function(){return n.publish("ROUTER:CUSTOM_HASH_CHANGE")}),n.publish("ROUTER:CUSTOM_HASH_CHANGE"),s=!0,n},attachStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return i=e,t.subscribe("STORE:SET",function(e){if("object"!==o(e))return l("STORE:SET expect object s argument"),!1;i=r({},i,e),t.publish("STORE:CHANGE",e)}),t.subscribe("STORE:GET",function(e){return i[e]}),p=!0,t},getActiveApp:function(){return a}}},i=c;t.default=i},function(e,t,n){"use strict";function r(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){function u(e,t){try{var n=a[e](t),u=n.value}catch(e){return void o(e)}n.done?r(u):Promise.resolve(u).then(c,i)}function c(e){u("next",e)}function i(e){u("throw",e)}var a=e.apply(t,n);c()})}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e){return new Promise(function(t,n){var r=null;if(document.querySelectorAll('[src="'.concat(e,'"]')).length||document.querySelectorAll('[href="'.concat(e,'"]')).length)return t(null);switch(!0){case!!e.match(/\.js$/g):r=document.createElement("script"),r.type="text/javascript",r.src=e,r.onload=function(){return t(null)},document.body.appendChild(r);break;case!!e.match(/\.css$/g):r=document.createElement("link"),r.rel="stylesheet",r.type="text/css",r.href=e,r.onload=function(){return t(null)},document.head.appendChild(r)}return entity?void 0:t(null)})},u=function(e){var t=function(){var e=r(regeneratorRuntime.mark(function e(t){var n,r,u,c,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=!0,r=!1,u=void 0,e.prev=3,c=t[Symbol.iterator]();case 5:if(n=(i=c.next()).done){e.next=12;break}return a=i.value,e.next=9,o(a);case 9:n=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),r=!0,u=e.t0;case 18:e.prev=18,e.prev=19,n||null==c.return||c.return();case 21:if(e.prev=21,!r){e.next=24;break}throw u;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25]])}));return function(t){return e.apply(this,arguments)}}();return"string"==typeof e?o(e):Array.isArray(e)?t(e):console.error("Loader expects string or array")},c=u;t.default=c}])});