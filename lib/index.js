!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.puppeteer=t():n.puppeteer=t()}(this,function(){return function(n){function t(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var e={};return t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:r})},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=0)}([function(n,t,e){"use strict";function r(){return r=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},r.apply(this,arguments)}function o(n){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=function(n){return n&&n.__esModule?n:{default:n}}(e(1)),i=function(n){var t=window,e={},i=n.loader||u.default,c={},a=null,s=!1,p=!1,f=function(){var t;n.dev&&(t=console).log.apply(t,arguments)},l=function(){var n;(n=console).warn.apply(n,arguments)},d=function(){var n;(n=console).error.apply(n,arguments)};return t.puppeteerActive=!0,"function"!=typeof i&&d("Provider app loader is not a function"),n.apps&&"object"===o(n.apps)||d('Missing "apps" object definition'),Object.keys(n.apps).forEach(function(t){var e=n.apps[t];e.bundleLocation||d('Missing "bundleLocation" for app',t),e.domHook||d('Missing "domHook" (element id) for app',t),e.mountFuncName||d('Missing "mountFuncName" (global mount function) for app',t)}),{subscribe:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};p&&["STORE:GET","STORE:SET","STORE:CHANGE"].includes(n)&&l("Piggybacking on STORE.GET/SET/CHANGE prohibited"),e.hasOwnProperty(n)||(e[n]=[]);var r=e[n].push(t)-1;return function(){return delete e[n][r]}},publish:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f("--- TOPIC LAUNCHED ---",n,t);var r=e[n]&&e[n].length?e[n].map(function(n){return n(t)}):[];return Promise.all(r)},store:function(n,t){if(!p)return l("Store is not attached",n,t),!1;var e=this;switch(n){case"GET":return e.publish("STORE:GET",t).then(function(n){return n[0]});case"SET":return e.publish("STORE:SET",t);case"CHANGE":return e.subscribe("STORE:CHANGE",t);default:l("Unrecognised Store action",n,t)}},generateAppEvents:function(){var e=this,r=n.apps;return Object.keys(r).forEach(function(n){e.subscribe("".concat(n.toUpperCase(),":MOUNT"),function(){return!!r[n].mounted||i(r[n].bundleLocation).then(function(){r[n].mounted=!0;var o=t[r[n].mountFuncName];if(!o)return l("Couldn't find mount function window."+r[n].mountFuncName),!1;r[n].unmount=o(e,r[n].domHook),e.publish("".concat(n.toUpperCase(),":MOUNT_SUCCESS"))})}),e.subscribe("".concat(n.toUpperCase(),":ACTION"),function(o){return r[n].mounted?a!==n&&(a&&r[a].unmount&&(e.publish("".concat(a.toUpperCase(),":UNMOUNT")),r[a].unmount||l(r[a].mountFuncName+"did not return unmount function"),r[a].unmount(),r[a].mounted=!1),a=n,void(!o.skipHashUpdate&&s&&(t.location.hash="#/".concat(n.toLowerCase())))):e.publish("".concat(n.toUpperCase(),":MOUNT")).then(function(){e.publish("".concat(n.toUpperCase(),":ACTION"),o)})})}),e},initiateAppRouter:function(){var e=this,r=n.apps;return e.subscribe("ROUTER:CUSTOM_HASH_CHANGE",function(){var n=t.location.hash,o=!1;if(Object.keys(r).forEach(function(t){var r=new RegExp("^#/"+t.toLowerCase()+"($|/)","g");n.match(r)&&(o=!0),n.match(r)&&a!==t&&e.publish("".concat(t.toUpperCase(),":ACTION"),{type:"openApp",skipHashUpdate:!0})}),o)return!0;e.publish("ROUTER:NONE_EXISTING_ROUTE"),a&&r[a].unmount&&(r[a].unmount(),r[a].mounted=!1,a=null)}),t.addEventListener("hashchange",function(){return e.publish("ROUTER:CUSTOM_HASH_CHANGE")}),e.publish("ROUTER:CUSTOM_HASH_CHANGE"),s=!0,e},attachStore:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return c=n,t.subscribe("STORE:SET",function(n){if("object"!==o(n))return l("STORE:SET expect object s argument"),!1;c=r({},c,n),t.publish("STORE:CHANGE",n)}),t.subscribe("STORE:GET",function(n){return c[n]}),p=!0,t},getActiveApp:function(){return a}}},c=i;t.default=c},function(n,t,e){"use strict";function r(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){function u(n,t){try{var e=a[n](t),u=e.value}catch(n){return void o(n)}e.done?r(u):Promise.resolve(u).then(i,c)}function i(n){u("next",n)}function c(n){u("throw",n)}var a=n.apply(t,e);i()})}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(n){return new Promise(function(t,e){if(document.querySelectorAll('[src="'.concat(n,'"]')).length)return t(null);var r=document.createElement("script");r.type="text/javascript",r.src=n,r.onload=function(){return t(null)},document.body.appendChild(r)})},u=function(n){var t=function(){var n=r(regeneratorRuntime.mark(function n(t){var e,r,u,i,c,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e=!0,r=!1,u=void 0,n.prev=3,i=t[Symbol.iterator]();case 5:if(e=(c=i.next()).done){n.next=12;break}return a=c.value,n.next=9,o(a);case 9:e=!0,n.next=5;break;case 12:n.next=18;break;case 14:n.prev=14,n.t0=n.catch(3),r=!0,u=n.t0;case 18:n.prev=18,n.prev=19,e||null==i.return||i.return();case 21:if(n.prev=21,!r){n.next=24;break}throw u;case 24:return n.finish(21);case 25:return n.finish(18);case 26:case"end":return n.stop()}},n,this,[[3,14,18,26],[19,,21,25]])}));return function(t){return n.apply(this,arguments)}}();return"string"==typeof n?o(n):Array.isArray(n)?t(n):console.error("Loader expects string or array")},i=u;t.default=i}])});